#!/usr/bin/env python

import pdbox
import sys


if __name__ == "__main__":
    args = pdbox.parsing.parse_args()
    kwargs = vars(args)
    pdbox.debug("Args: %s" % args, **kwargs)
    pdbox.auth.login(pdbox.auth.get_token(**kwargs))
    try:
        retval = args.func(**kwargs)
    except KeyboardInterrupt:
        print("")
        pdbox.error("Interrupted")
        retval = False
    if kwargs.get("dryrun"):
        pdbox.info("--dryrun is set: no operations were performed")
    sys.exit(not retval)
